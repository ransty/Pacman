<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>pacman API documentation</title>
    <meta name="description" content="Pacman.py holds the logic for the classic pacman game along with the main
code to run a game.  This ..." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#pacman.COLLISION_TOLERANCE">COLLISION_TOLERANCE</a></li>
    <li class="mono"><a href="#pacman.SCARED_TIME">SCARED_TIME</a></li>
    <li class="mono"><a href="#pacman.TIME_PENALTY">TIME_PENALTY</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#pacman.default">default</a></li>
    <li class="mono"><a href="#pacman.loadAgent">loadAgent</a></li>
    <li class="mono"><a href="#pacman.parseAgentArgs">parseAgentArgs</a></li>
    <li class="mono"><a href="#pacman.readCommand">readCommand</a></li>
    <li class="mono"><a href="#pacman.replayGame">replayGame</a></li>
    <li class="mono"><a href="#pacman.runGames">runGames</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#pacman.ClassicGameRules">ClassicGameRules</a></span>
        
          
  <ul>
    <li class="mono"><a href="#pacman.ClassicGameRules.__init__">__init__</a></li>
    <li class="mono"><a href="#pacman.ClassicGameRules.agentCrash">agentCrash</a></li>
    <li class="mono"><a href="#pacman.ClassicGameRules.getMaxStartupTime">getMaxStartupTime</a></li>
    <li class="mono"><a href="#pacman.ClassicGameRules.getMaxTimeWarnings">getMaxTimeWarnings</a></li>
    <li class="mono"><a href="#pacman.ClassicGameRules.getMaxTotalTime">getMaxTotalTime</a></li>
    <li class="mono"><a href="#pacman.ClassicGameRules.getMoveTimeout">getMoveTimeout</a></li>
    <li class="mono"><a href="#pacman.ClassicGameRules.getMoveWarningTime">getMoveWarningTime</a></li>
    <li class="mono"><a href="#pacman.ClassicGameRules.getProgress">getProgress</a></li>
    <li class="mono"><a href="#pacman.ClassicGameRules.lose">lose</a></li>
    <li class="mono"><a href="#pacman.ClassicGameRules.newGame">newGame</a></li>
    <li class="mono"><a href="#pacman.ClassicGameRules.process">process</a></li>
    <li class="mono"><a href="#pacman.ClassicGameRules.win">win</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#pacman.GameState">GameState</a></span>
        
          
  <ul>
    <li class="mono"><a href="#pacman.GameState.__init__">__init__</a></li>
    <li class="mono"><a href="#pacman.GameState.deepCopy">deepCopy</a></li>
    <li class="mono"><a href="#pacman.GameState.generatePacmanSuccessor">generatePacmanSuccessor</a></li>
    <li class="mono"><a href="#pacman.GameState.generateSuccessor">generateSuccessor</a></li>
    <li class="mono"><a href="#pacman.GameState.getAndResetExplored">getAndResetExplored</a></li>
    <li class="mono"><a href="#pacman.GameState.getCapsules">getCapsules</a></li>
    <li class="mono"><a href="#pacman.GameState.getFood">getFood</a></li>
    <li class="mono"><a href="#pacman.GameState.getGhostPosition">getGhostPosition</a></li>
    <li class="mono"><a href="#pacman.GameState.getGhostPositions">getGhostPositions</a></li>
    <li class="mono"><a href="#pacman.GameState.getGhostState">getGhostState</a></li>
    <li class="mono"><a href="#pacman.GameState.getGhostStates">getGhostStates</a></li>
    <li class="mono"><a href="#pacman.GameState.getLegalActions">getLegalActions</a></li>
    <li class="mono"><a href="#pacman.GameState.getLegalPacmanActions">getLegalPacmanActions</a></li>
    <li class="mono"><a href="#pacman.GameState.getNumAgents">getNumAgents</a></li>
    <li class="mono"><a href="#pacman.GameState.getNumFood">getNumFood</a></li>
    <li class="mono"><a href="#pacman.GameState.getPacmanPosition">getPacmanPosition</a></li>
    <li class="mono"><a href="#pacman.GameState.getPacmanState">getPacmanState</a></li>
    <li class="mono"><a href="#pacman.GameState.getScore">getScore</a></li>
    <li class="mono"><a href="#pacman.GameState.getWalls">getWalls</a></li>
    <li class="mono"><a href="#pacman.GameState.hasFood">hasFood</a></li>
    <li class="mono"><a href="#pacman.GameState.hasWall">hasWall</a></li>
    <li class="mono"><a href="#pacman.GameState.initialize">initialize</a></li>
    <li class="mono"><a href="#pacman.GameState.isLose">isLose</a></li>
    <li class="mono"><a href="#pacman.GameState.isWin">isWin</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#pacman.GhostRules">GhostRules</a></span>
        
          
  <ul>
    <li class="mono"><a href="#pacman.GhostRules.applyAction">applyAction</a></li>
    <li class="mono"><a href="#pacman.GhostRules.canKill">canKill</a></li>
    <li class="mono"><a href="#pacman.GhostRules.checkDeath">checkDeath</a></li>
    <li class="mono"><a href="#pacman.GhostRules.collide">collide</a></li>
    <li class="mono"><a href="#pacman.GhostRules.decrementTimer">decrementTimer</a></li>
    <li class="mono"><a href="#pacman.GhostRules.getLegalActions">getLegalActions</a></li>
    <li class="mono"><a href="#pacman.GhostRules.placeGhost">placeGhost</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#pacman.PacmanRules">PacmanRules</a></span>
        
          
  <ul>
    <li class="mono"><a href="#pacman.PacmanRules.applyAction">applyAction</a></li>
    <li class="mono"><a href="#pacman.PacmanRules.consume">consume</a></li>
    <li class="mono"><a href="#pacman.PacmanRules.getLegalActions">getLegalActions</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">pacman</span> module</h1>
  <p>Pacman.py holds the logic for the classic pacman game along with the main
code to run a game.  This file is divided into three sections:</p>
<p>(i)  Your interface to the pacman world:
          Pacman is a complex environment.  You probably don't want to
          read through all of the code we wrote to make the game runs
          correctly.  This section contains the parts of the code
          that you will need to understand in order to complete the
          project.  There is also some code in game.py that you should
          understand.</p>
<p>(ii)  The hidden secrets of pacman:
          This section contains all of the logic code that the pacman
          environment uses to decide who can move where, who dies when
          things collide, etc.  You shouldn't need to read this section
          of code, but you can if you want.</p>
<p>(iii) Framework to start a game:
          The final section contains the code for reading the command
          you use to set up the game, then starting up a new game, along with
          linking in all the external parts (agent functions, graphics).
          Check this section out to see all the options available to you.</p>
<p>To play your first game, type 'python pacman.py' from the command line.
The keys are 'a', 's', 'd', and 'w' to move (or arrow keys).  Have fun!</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman', this);">Show source &equiv;</a></p>
  <div id="source-pacman" class="source">
    <div class="codehilite"><pre><span></span><span class="c1"># pacman.py</span>
<span class="c1"># ---------</span>
<span class="c1"># Licensing Information: Please do not distribute or publish solutions to this</span>
<span class="c1"># project. You are free to use and extend these projects for educational</span>
<span class="c1"># purposes. The Pacman AI projects were developed at UC Berkeley, primarily by</span>
<span class="c1"># John DeNero (denero@cs.berkeley.edu) and Dan Klein (klein@cs.berkeley.edu).</span>
<span class="c1"># For more info, see http://inst.eecs.berkeley.edu/~cs188/sp09/pacman.html</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Pacman.py holds the logic for the classic pacman game along with the main</span>
<span class="sd">code to run a game.  This file is divided into three sections:</span>

<span class="sd">  (i)  Your interface to the pacman world:</span>
<span class="sd">          Pacman is a complex environment.  You probably don&#39;t want to</span>
<span class="sd">          read through all of the code we wrote to make the game runs</span>
<span class="sd">          correctly.  This section contains the parts of the code</span>
<span class="sd">          that you will need to understand in order to complete the</span>
<span class="sd">          project.  There is also some code in game.py that you should</span>
<span class="sd">          understand.</span>

<span class="sd">  (ii)  The hidden secrets of pacman:</span>
<span class="sd">          This section contains all of the logic code that the pacman</span>
<span class="sd">          environment uses to decide who can move where, who dies when</span>
<span class="sd">          things collide, etc.  You shouldn&#39;t need to read this section</span>
<span class="sd">          of code, but you can if you want.</span>

<span class="sd">  (iii) Framework to start a game:</span>
<span class="sd">          The final section contains the code for reading the command</span>
<span class="sd">          you use to set up the game, then starting up a new game, along with</span>
<span class="sd">          linking in all the external parts (agent functions, graphics).</span>
<span class="sd">          Check this section out to see all the options available to you.</span>

<span class="sd">To play your first game, type &#39;python pacman.py&#39; from the command line.</span>
<span class="sd">The keys are &#39;a&#39;, &#39;s&#39;, &#39;d&#39;, and &#39;w&#39; to move (or arrow keys).  Have fun!</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">ghostAgents</span>
<span class="kn">import</span> <span class="nn">graphicsDisplay</span>
<span class="kn">import</span> <span class="nn">layout</span>
<span class="kn">import</span> <span class="nn">pacmanAgents</span>
<span class="kn">from</span> <span class="nn">game</span> <span class="kn">import</span> <span class="n">Actions</span>
<span class="kn">from</span> <span class="nn">game</span> <span class="kn">import</span> <span class="n">Directions</span>
<span class="kn">from</span> <span class="nn">game</span> <span class="kn">import</span> <span class="n">Game</span>
<span class="kn">from</span> <span class="nn">game</span> <span class="kn">import</span> <span class="n">GameStateData</span>
<span class="kn">from</span> <span class="nn">optparse</span> <span class="kn">import</span> <span class="n">OptionParser</span>
<span class="kn">from</span> <span class="nn">util</span> <span class="kn">import</span> <span class="n">manhattanDistance</span>
<span class="kn">from</span> <span class="nn">util</span> <span class="kn">import</span> <span class="n">nearestPoint</span>


<span class="c1">###################################################</span>
<span class="c1"># YOUR INTERFACE TO THE PACMAN WORLD: A GameState #</span>
<span class="c1">###################################################</span>

<span class="k">class</span> <span class="nc">GameState</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A GameState specifies the full game state, including the food, capsules,</span>
<span class="sd">    agent configurations and score changes.</span>

<span class="sd">    GameStates are used by the Game object to capture the actual state of the game and</span>
<span class="sd">    can be used by agents to reason about the game.</span>

<span class="sd">    Much of the information in a GameState is stored in a GameStateData object.  We</span>
<span class="sd">    strongly suggest that you access that data via the accessor methods below rather</span>
<span class="sd">    than referring to the GameStateData object directly.</span>

<span class="sd">    Note that in classic Pacman, Pacman is always agent 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">####################################################</span>
    <span class="c1"># Accessor methods: use these to access state data #</span>
    <span class="c1">####################################################</span>

    <span class="c1"># static variable keeps track of which states have had getLegalActions called</span>
    <span class="n">explored</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getAndResetExplored</span><span class="p">():</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">GameState</span><span class="o">.</span><span class="n">explored</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">GameState</span><span class="o">.</span><span class="n">explored</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">tmp</span>

    <span class="n">getAndResetExplored</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">getAndResetExplored</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getLegalActions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the legal actions for the agent specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">GameState</span><span class="o">.</span><span class="n">explored</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isWin</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">isLose</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Pacman is moving</span>
            <span class="k">return</span> <span class="n">PacmanRules</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generateSuccessor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the successor state after the specified agent takes the action.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check that successors exist</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isWin</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">isLose</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Can</span><span class="se">\&#39;</span><span class="s1">t generate a successor of a terminal state.&#39;</span><span class="p">)</span>

        <span class="c1"># Copy current state</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Let agent&#39;s logic deal with its action&#39;s effects on the board</span>
        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Pacman is moving</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_eaten</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="n">state</span><span class="o">.</span><span class="n">getNumAgents</span><span class="p">()</span>
            <span class="n">PacmanRules</span><span class="o">.</span><span class="n">applyAction</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># A ghost is moving</span>
            <span class="n">GhostRules</span><span class="o">.</span><span class="n">applyAction</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">)</span>

        <span class="c1"># Time passes</span>
        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">+=</span> <span class="o">-</span><span class="n">TIME_PENALTY</span>  <span class="c1"># Penalty for waiting around</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">GhostRules</span><span class="o">.</span><span class="n">decrementTimer</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">])</span>

        <span class="c1"># Resolve multi-agent effects</span>
        <span class="n">GhostRules</span><span class="o">.</span><span class="n">checkDeath</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">)</span>

        <span class="c1"># Book keeping</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_agentMoved</span> <span class="o">=</span> <span class="n">agentIndex</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">score</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">getLegalPacmanActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generatePacmanSuccessor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the successor state after the specified pacman move</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getPacmanState</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an AgentState object for pacman (in game.py)</span>

<span class="sd">        state.pos gives the current position</span>
<span class="sd">        state.direction gives the travel vector</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getPacmanPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getGhostStates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">def</span> <span class="nf">getGhostState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">agentIndex</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumAgents</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid index passed to getGhostState&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">getGhostPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Pacman&#39;s index passed to getGhostPosition&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">]</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getGhostPositions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGhostStates</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">getNumAgents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getScore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">score</span>

    <span class="k">def</span> <span class="nf">getCapsules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of positions (x,y) of the remaining capsules.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">capsules</span>

    <span class="k">def</span> <span class="nf">getNumFood</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getFood</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a Grid of boolean food indicator variables.</span>

<span class="sd">        Grids can be accessed via list notation, so to check</span>
<span class="sd">        if there is food at (x,y), just call</span>

<span class="sd">        currentFood = state.getFood()</span>
<span class="sd">        if currentFood[x][y] == True: ...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span>

    <span class="k">def</span> <span class="nf">getWalls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a Grid of boolean wall indicator variables.</span>

<span class="sd">        Grids can be accessed via list notation, so to check</span>
<span class="sd">        if there is food at (x,y), just call</span>

<span class="sd">        walls = state.getWalls()</span>
<span class="sd">        if walls[x][y] == True: ...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">walls</span>

    <span class="k">def</span> <span class="nf">hasFood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">hasWall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">walls</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">isLose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_lose</span>

    <span class="k">def</span> <span class="nf">isWin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_win</span>

    <span class="c1">#############################################</span>
    <span class="c1">#             Helper methods:               #</span>
    <span class="c1"># You shouldn&#39;t need to call these directly #</span>
    <span class="c1">#############################################</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prevState</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a new state by copying information from its predecessor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">prevState</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>  <span class="c1"># Initial state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">GameStateData</span><span class="p">(</span><span class="n">prevState</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">GameStateData</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">deepCopy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">deepCopy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows two states to be compared.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows states to be keys of dictionaries.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout</span><span class="p">,</span> <span class="n">numGhostAgents</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an initial game state from a layout array (see layout.py).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">numGhostAgents</span><span class="p">)</span>


<span class="c1">############################################################################</span>
<span class="c1">#                     THE HIDDEN SECRETS OF PACMAN                         #</span>
<span class="c1">#                                                                          #</span>
<span class="c1"># You shouldn&#39;t need to look through the code in this section of the file. #</span>
<span class="c1">############################################################################</span>

<span class="n">SCARED_TIME</span> <span class="o">=</span> <span class="mi">40</span>  <span class="c1"># Moves ghosts are scared</span>
<span class="n">COLLISION_TOLERANCE</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1"># How close ghosts must be to Pacman to kill</span>
<span class="n">TIME_PENALTY</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Number of points lost each round</span>


<span class="k">class</span> <span class="nc">ClassicGameRules</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    These game rules manage the control flow of a game, deciding when</span>
<span class="sd">    and how the game starts and ends.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialState</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">newGame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout</span><span class="p">,</span> <span class="n">pacmanAgent</span><span class="p">,</span> <span class="n">ghostAgents</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">catchExceptions</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="n">pacmanAgent</span><span class="o">.</span><span class="n">prepareForNewGame</span><span class="p">()</span>
        <span class="n">agents</span> <span class="o">=</span> <span class="p">[</span><span class="n">pacmanAgent</span><span class="p">]</span> <span class="o">+</span> <span class="n">ghostAgents</span><span class="p">[:</span><span class="n">layout</span><span class="o">.</span><span class="n">getNumGhosts</span><span class="p">()]</span>
        <span class="n">initState</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">()</span>
        <span class="n">initState</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ghostAgents</span><span class="p">))</span>
        <span class="n">game</span> <span class="o">=</span> <span class="n">Game</span><span class="p">(</span><span class="n">agents</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">catchExceptions</span><span class="o">=</span><span class="n">catchExceptions</span><span class="p">)</span>
        <span class="n">game</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">initState</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialState</span> <span class="o">=</span> <span class="n">initState</span><span class="o">.</span><span class="n">deepCopy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="n">quiet</span>
        <span class="k">return</span> <span class="n">game</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks to see whether it is time to end the game.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">isWin</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">win</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">isLose</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lose</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">win</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Pacman emerges victorious! Score: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
        <span class="n">game</span><span class="o">.</span><span class="n">gameOver</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">lose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Pacman died! Score: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
        <span class="n">game</span><span class="o">.</span><span class="n">gameOver</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">getProgress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">game</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">getNumFood</span><span class="p">())</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialState</span><span class="o">.</span><span class="n">getNumFood</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">agentCrash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Pacman crashed&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;A ghost crashed&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getMaxTotalTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>

    <span class="k">def</span> <span class="nf">getMaxStartupTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>

    <span class="k">def</span> <span class="nf">getMoveWarningTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>

    <span class="k">def</span> <span class="nf">getMoveTimeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>

    <span class="k">def</span> <span class="nf">getMaxTimeWarnings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>


<span class="k">class</span> <span class="nc">PacmanRules</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    These functions govern how pacman interacts with his environment under</span>
<span class="sd">    the classic game rules.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PACMAN_SPEED</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">getLegalActions</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of possible actions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Actions</span><span class="o">.</span><span class="n">getPossibleActions</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">getPacmanState</span><span class="p">()</span><span class="o">.</span><span class="n">configuration</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">walls</span><span class="p">)</span>

    <span class="n">getLegalActions</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">getLegalActions</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">applyAction</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Edits the state to reflect the results of the action.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">legal</span> <span class="o">=</span> <span class="n">PacmanRules</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">action</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">legal</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Illegal action &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">action</span><span class="p">))</span>

        <span class="n">pacmanState</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Update Configuration</span>
        <span class="n">vector</span> <span class="o">=</span> <span class="n">Actions</span><span class="o">.</span><span class="n">directionToVector</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">PacmanRules</span><span class="o">.</span><span class="n">PACMAN_SPEED</span><span class="p">)</span>
        <span class="n">pacmanState</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="n">pacmanState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>

        <span class="c1"># Eat</span>
        <span class="nb">next</span> <span class="o">=</span> <span class="n">pacmanState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
        <span class="n">nearest</span> <span class="o">=</span> <span class="n">nearestPoint</span><span class="p">(</span><span class="nb">next</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">manhattanDistance</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="c1"># Remove food</span>
            <span class="n">PacmanRules</span><span class="o">.</span><span class="n">consume</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

    <span class="n">applyAction</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">applyAction</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">position</span>
        <span class="c1"># Eat food</span>
        <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">+=</span> <span class="mi">10</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_foodEaten</span> <span class="o">=</span> <span class="n">position</span>
            <span class="c1"># TODO: cache numFood?</span>
            <span class="n">numFood</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">getNumFood</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">numFood</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_lose</span><span class="p">:</span>
                <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">+=</span> <span class="mi">500</span>
                <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_win</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="c1"># Eat capsule</span>
        <span class="k">if</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">getCapsules</span><span class="p">():</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">capsules</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_capsuleEaten</span> <span class="o">=</span> <span class="n">position</span>
            <span class="c1"># Reset all ghosts&#39; scared timers</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">)):</span>
                <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">=</span> <span class="n">SCARED_TIME</span>

    <span class="n">consume</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">consume</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">GhostRules</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    These functions dictate how ghosts interact with their environment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">GHOST_SPEED</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">def</span> <span class="nf">getLegalActions</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostIndex</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ghosts cannot stop, and cannot turn around unless they</span>
<span class="sd">        reach a dead end, but can turn 90 degrees at intersections.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">conf</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">getGhostState</span><span class="p">(</span><span class="n">ghostIndex</span><span class="p">)</span><span class="o">.</span><span class="n">configuration</span>
        <span class="n">possibleActions</span> <span class="o">=</span> <span class="n">Actions</span><span class="o">.</span><span class="n">getPossibleActions</span><span class="p">(</span><span class="n">conf</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">walls</span><span class="p">)</span>
        <span class="n">reverse</span> <span class="o">=</span> <span class="n">Actions</span><span class="o">.</span><span class="n">reverseDirection</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Directions</span><span class="o">.</span><span class="n">STOP</span> <span class="ow">in</span> <span class="n">possibleActions</span><span class="p">:</span>
            <span class="n">possibleActions</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">Directions</span><span class="o">.</span><span class="n">STOP</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reverse</span> <span class="ow">in</span> <span class="n">possibleActions</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">possibleActions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">possibleActions</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">reverse</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">possibleActions</span>

    <span class="n">getLegalActions</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">getLegalActions</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">applyAction</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">ghostIndex</span><span class="p">):</span>

        <span class="n">legal</span> <span class="o">=</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostIndex</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">action</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">legal</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Illegal ghost action &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">action</span><span class="p">))</span>

        <span class="n">ghostState</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">ghostIndex</span><span class="p">]</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">GHOST_SPEED</span>
        <span class="k">if</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">speed</span> <span class="o">/=</span> <span class="mf">2.0</span>
        <span class="n">vector</span> <span class="o">=</span> <span class="n">Actions</span><span class="o">.</span><span class="n">directionToVector</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">speed</span><span class="p">)</span>
        <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>

    <span class="n">applyAction</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">applyAction</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">decrementTimer</span><span class="p">(</span><span class="n">ghostState</span><span class="p">):</span>
        <span class="n">timer</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span>
        <span class="k">if</span> <span class="n">timer</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">nearestPoint</span><span class="p">(</span><span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">timer</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">decrementTimer</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">decrementTimer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">checkDeath</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="n">pacmanPosition</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">getPacmanPosition</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Pacman just moved; Anyone can kill him</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">)):</span>
                <span class="n">ghostState</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                <span class="n">ghostPosition</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">canKill</span><span class="p">(</span><span class="n">pacmanPosition</span><span class="p">,</span> <span class="n">ghostPosition</span><span class="p">):</span>
                    <span class="n">GhostRules</span><span class="o">.</span><span class="n">collide</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ghostState</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">]</span>
            <span class="n">ghostPosition</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">canKill</span><span class="p">(</span><span class="n">pacmanPosition</span><span class="p">,</span> <span class="n">ghostPosition</span><span class="p">):</span>
                <span class="n">GhostRules</span><span class="o">.</span><span class="n">collide</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">)</span>

    <span class="n">checkDeath</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">checkDeath</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">collide</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">+=</span> <span class="mi">200</span>
            <span class="n">GhostRules</span><span class="o">.</span><span class="n">placeGhost</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">)</span>
            <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># Added for first-person</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_eaten</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_win</span><span class="p">:</span>
                <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">-=</span> <span class="mi">500</span>
                <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_lose</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="n">collide</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">collide</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">canKill</span><span class="p">(</span><span class="n">pacmanPosition</span><span class="p">,</span> <span class="n">ghostPosition</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">manhattanDistance</span><span class="p">(</span><span class="n">ghostPosition</span><span class="p">,</span> <span class="n">pacmanPosition</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">COLLISION_TOLERANCE</span>

    <span class="n">canKill</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">canKill</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">placeGhost</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">):</span>
        <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">start</span>

    <span class="n">placeGhost</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">placeGhost</span><span class="p">)</span>


<span class="c1">#############################</span>
<span class="c1"># FRAMEWORK TO START A GAME #</span>
<span class="c1">#############################</span>

<span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">str</span> <span class="o">+</span> <span class="s1">&#39; [Default: </span><span class="si">%d</span><span class="s1">efault]&#39;</span>


<span class="k">def</span> <span class="nf">parseAgentArgs</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">str</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>
    <span class="n">pieces</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">opts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pieces</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">p</span><span class="p">,</span> <span class="mi">1</span>
        <span class="n">opts</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
    <span class="k">return</span> <span class="n">opts</span>


<span class="k">def</span> <span class="nf">readCommand</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Processes the command used to run pacman from the command line.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">usageStr</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    USAGE:      python pacman.py &lt;options&gt;</span>
<span class="s2">    EXAMPLES:   (1) python pacman.py</span>
<span class="s2">                    - starts an interactive game</span>
<span class="s2">                (2) python pacman.py --layout smallClassic --zoom 2</span>
<span class="s2">                OR  python pacman.py -l smallClassic -z 2</span>
<span class="s2">                    - starts an interactive game on a smaller board, zoomed in</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">usageStr</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-n&#39;</span><span class="p">,</span> <span class="s1">&#39;--numGames&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;numGames&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;the number of GAMES to play&#39;</span><span class="p">),</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;GAMES&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-l&#39;</span><span class="p">,</span> <span class="s1">&#39;--layout&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;layout&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;the LAYOUT_FILE from which to load the map layout&#39;</span><span class="p">),</span>
                      <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;LAYOUT_FILE&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;mediumClassic&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="s1">&#39;--pacman&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;pacman&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;the agent TYPE in the pacmanAgents module to use&#39;</span><span class="p">),</span>
                      <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;TYPE&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;KeyboardAgent&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="s1">&#39;--textGraphics&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;textGraphics&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Display output as text only&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-q&#39;</span><span class="p">,</span> <span class="s1">&#39;--quietTextGraphics&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;quietGraphics&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Generate minimal output and no graphics&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-g&#39;</span><span class="p">,</span> <span class="s1">&#39;--ghosts&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;ghost&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;the ghost agent TYPE in the ghostAgents module to use&#39;</span><span class="p">),</span>
                      <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;TYPE&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;RandomGhost&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="s1">&#39;--numghosts&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;numGhosts&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;The maximum number of ghosts to use&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-z&#39;</span><span class="p">,</span> <span class="s1">&#39;--zoom&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;zoom&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;Zoom the size of the graphics window&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="s1">&#39;--fixRandomSeed&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;fixRandomSeed&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Fixes the random seed to always play the same game&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="s1">&#39;--recordActions&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;record&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Writes game histories to a file (named by the time they were played)&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;--replay&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;gameToReplay&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;A recorded game file (pickle) to replay&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-a&#39;</span><span class="p">,</span> <span class="s1">&#39;--agentArgs&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;agentArgs&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Comma separated values sent to agent. e.g. &quot;opt1=val1,opt2,opt3=val3&quot;&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-x&#39;</span><span class="p">,</span> <span class="s1">&#39;--numTraining&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;numTraining&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;How many episodes are training (suppresses output)&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;--frameTime&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;frameTime&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;Time to delay between frames; &lt;0 means keyboard&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span> <span class="s1">&#39;--catchExceptions&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;catchExceptions&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Turns on exception handling and timeouts during games&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;--timeout&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;timeout&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;Maximum length of time an agent can spend computing in a single game&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

    <span class="n">options</span><span class="p">,</span> <span class="n">otherjunk</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherjunk</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Command line input not understood: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">otherjunk</span><span class="p">))</span>
    <span class="n">args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="c1"># Fix the random seed</span>
    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">fixRandomSeed</span><span class="p">:</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="s1">&#39;cs188&#39;</span><span class="p">)</span>

    <span class="c1"># Choose a layout</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">getLayout</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The layout &quot;</span> <span class="o">+</span> <span class="n">options</span><span class="o">.</span><span class="n">layout</span> <span class="o">+</span> <span class="s2">&quot; cannot be found&quot;</span><span class="p">)</span>

    <span class="c1"># Choose a Pacman agent</span>
    <span class="n">noKeyboard</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">gameToReplay</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">textGraphics</span> <span class="ow">or</span> <span class="n">options</span><span class="o">.</span><span class="n">quietGraphics</span><span class="p">)</span>
    <span class="n">pacmanType</span> <span class="o">=</span> <span class="n">loadAgent</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">pacman</span><span class="p">,</span> <span class="n">noKeyboard</span><span class="p">)</span>
    <span class="n">agentOpts</span> <span class="o">=</span> <span class="n">parseAgentArgs</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">agentArgs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">numTraining</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;numTraining&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">numTraining</span>
        <span class="k">if</span> <span class="s1">&#39;numTraining&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">agentOpts</span><span class="p">:</span>
            <span class="n">agentOpts</span><span class="p">[</span><span class="s1">&#39;numTraining&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">numTraining</span>
    <span class="n">pacman</span> <span class="o">=</span> <span class="n">pacmanType</span><span class="p">(</span><span class="o">**</span><span class="n">agentOpts</span><span class="p">)</span>  <span class="c1"># Instantiate Pacman with agentArgs</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;pacman&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pacman</span>

    <span class="c1"># Don&#39;t display training games</span>
    <span class="k">if</span> <span class="s1">&#39;numTrain&#39;</span> <span class="ow">in</span> <span class="n">agentOpts</span><span class="p">:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">numQuiet</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">agentOpts</span><span class="p">[</span><span class="s1">&#39;numTrain&#39;</span><span class="p">])</span>
        <span class="n">options</span><span class="o">.</span><span class="n">numIgnore</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">agentOpts</span><span class="p">[</span><span class="s1">&#39;numTrain&#39;</span><span class="p">])</span>

    <span class="c1"># Choose a ghost agent</span>
    <span class="n">ghostType</span> <span class="o">=</span> <span class="n">loadAgent</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">ghost</span><span class="p">,</span> <span class="n">noKeyboard</span><span class="p">)</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;ghosts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ghostType</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">numGhosts</span><span class="p">)]</span>

    <span class="c1"># Choose a display format</span>
    <span class="kn">import</span> <span class="nn">textDisplay</span>  <span class="c1"># can&#39;t import at the top, because of cyclic import dependencies :-(</span>
    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">quietGraphics</span><span class="p">:</span>
        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;display&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">textDisplay</span><span class="o">.</span><span class="n">NullGraphics</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">options</span><span class="o">.</span><span class="n">textGraphics</span><span class="p">:</span>
        <span class="n">textDisplay</span><span class="o">.</span><span class="n">SLEEP_TIME</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">frameTime</span>
        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;display&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">textDisplay</span><span class="o">.</span><span class="n">PacmanGraphics</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;display&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphicsDisplay</span><span class="o">.</span><span class="n">PacmanGraphics</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">zoom</span><span class="p">,</span> <span class="n">frameTime</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">frameTime</span><span class="p">)</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;numGames&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">numGames</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;record&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">record</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;catchExceptions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">catchExceptions</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;timeout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">timeout</span>

    <span class="c1"># Special case: recorded games don&#39;t use the runGames method or args structure</span>
    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">gameToReplay</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Replaying recorded game </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="n">options</span><span class="o">.</span><span class="n">gameToReplay</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">gameToReplay</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">recorded</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">recorded</span><span class="p">[</span><span class="s1">&#39;display&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;display&#39;</span><span class="p">]</span>
        <span class="n">replayGame</span><span class="p">(</span><span class="o">**</span><span class="n">recorded</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">args</span>


<span class="k">def</span> <span class="nf">loadAgent</span><span class="p">(</span><span class="n">pacman</span><span class="p">,</span> <span class="n">nographics</span><span class="p">):</span>
    <span class="c1"># Looks through all pythonPath Directories for the right module,</span>
    <span class="n">pythonPathStr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="s2">&quot;$PYTHONPATH&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pythonPathStr</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">pythonPathDirs</span> <span class="o">=</span> <span class="n">pythonPathStr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pythonPathDirs</span> <span class="o">=</span> <span class="n">pythonPathStr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="n">pythonPathDirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">moduleDir</span> <span class="ow">in</span> <span class="n">pythonPathDirs</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">moduleDir</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">moduleNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">moduleDir</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;gents.py&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">modulename</span> <span class="ow">in</span> <span class="n">moduleNames</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">modulename</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">pacman</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">module</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">nographics</span> <span class="ow">and</span> <span class="n">modulename</span> <span class="o">==</span> <span class="s1">&#39;keyboardAgents.py&#39;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Using the keyboard requires graphics (not text display)&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">pacman</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;The agent &#39;</span> <span class="o">+</span> <span class="n">pacman</span> <span class="o">+</span> <span class="s1">&#39; is not specified in any *Agents.py.&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">replayGame</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">display</span><span class="p">):</span>
    <span class="n">rules</span> <span class="o">=</span> <span class="n">ClassicGameRules</span><span class="p">()</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="p">[</span><span class="n">pacmanAgents</span><span class="o">.</span><span class="n">GreedyAgent</span><span class="p">()]</span> <span class="o">+</span> <span class="p">[</span><span class="n">ghostAgents</span><span class="o">.</span><span class="n">RandomGhost</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">layout</span><span class="o">.</span><span class="n">getNumGhosts</span><span class="p">())]</span>
    <span class="n">game</span> <span class="o">=</span> <span class="n">rules</span><span class="o">.</span><span class="n">newGame</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">agents</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">agents</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">display</span><span class="p">)</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">state</span>
    <span class="n">display</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
        <span class="c1"># Execute the action</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="o">*</span><span class="n">action</span><span class="p">)</span>
        <span class="c1"># Change the display</span>
        <span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># Allow for game specific conditions (winning, losing, etc.)</span>
        <span class="n">rules</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">)</span>

    <span class="n">display</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">runGames</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">pacman</span><span class="p">,</span> <span class="n">ghosts</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">numGames</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">numTraining</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">catchExceptions</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
    <span class="n">rules</span> <span class="o">=</span> <span class="n">ClassicGameRules</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
    <span class="n">games</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numGames</span><span class="p">):</span>
        <span class="n">beQuiet</span> <span class="o">=</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">numTraining</span>
        <span class="k">if</span> <span class="n">beQuiet</span><span class="p">:</span>
            <span class="c1"># Suppress output and graphics</span>
            <span class="kn">import</span> <span class="nn">textDisplay</span>  <span class="c1"># can&#39;t import at the top, because of cyclic import dependencies :-(</span>
            <span class="n">gameDisplay</span> <span class="o">=</span> <span class="n">textDisplay</span><span class="o">.</span><span class="n">NullGraphics</span><span class="p">()</span>
            <span class="n">rules</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gameDisplay</span> <span class="o">=</span> <span class="n">display</span>
            <span class="n">rules</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">game</span> <span class="o">=</span> <span class="n">rules</span><span class="o">.</span><span class="n">newGame</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">pacman</span><span class="p">,</span> <span class="n">ghosts</span><span class="p">,</span> <span class="n">gameDisplay</span><span class="p">,</span> <span class="n">beQuiet</span><span class="p">,</span> <span class="n">catchExceptions</span><span class="p">)</span>
        <span class="n">game</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">beQuiet</span><span class="p">:</span>
            <span class="n">games</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">game</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">record</span><span class="p">:</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;recorded-game-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]])</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">components</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;layout&#39;</span><span class="p">:</span> <span class="n">layout</span><span class="p">,</span> <span class="s1">&#39;actions&#39;</span><span class="p">:</span> <span class="n">game</span><span class="o">.</span><span class="n">moveHistory</span><span class="p">}</span>
                <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">numGames</span> <span class="o">-</span> <span class="n">numTraining</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">game</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">getScore</span><span class="p">()</span> <span class="k">for</span> <span class="n">game</span> <span class="ow">in</span> <span class="n">games</span><span class="p">]</span>
        <span class="n">wins</span> <span class="o">=</span> <span class="p">[</span><span class="n">game</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">isWin</span><span class="p">()</span> <span class="k">for</span> <span class="n">game</span> <span class="ow">in</span> <span class="n">games</span><span class="p">]</span>
        <span class="n">winRate</span> <span class="o">=</span> <span class="n">wins</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wins</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Average Score:&#39;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="p">)))</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Scores:       &#39;</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">]))</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Win Rate:      </span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1"> (</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wins</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="bp">True</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wins</span><span class="p">),</span> <span class="n">winRate</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Record:       &#39;</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([[</span><span class="s1">&#39;Loss&#39;</span><span class="p">,</span> <span class="s1">&#39;Win&#39;</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">w</span><span class="p">)]</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">wins</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">games</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The main function called when pacman.py is run</span>
<span class="sd">    from the command line:</span>

<span class="sd">    &gt; python pacman.py</span>

<span class="sd">    See the usage string for more details.</span>

<span class="sd">    &gt; python pacman.py --help</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">readCommand</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>  <span class="c1"># Get game components based on input</span>
    <span class="n">runGames</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="pacman.COLLISION_TOLERANCE" class="name">var <span class="ident">COLLISION_TOLERANCE</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="pacman.SCARED_TIME" class="name">var <span class="ident">SCARED_TIME</span></p>
      
  
  <div class="source_cont">
</div>

      </div>
      <div class="item">
      <p id="pacman.TIME_PENALTY" class="name">var <span class="ident">TIME_PENALTY</span></p>
      
  
  <div class="source_cont">
</div>

      </div>

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="pacman.default">
    <p>def <span class="ident">default</span>(</p><p>str)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.default', this);">Show source &equiv;</a></p>
  <div id="source-pacman.default" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">str</span> <span class="o">+</span> <span class="s1">&#39; [Default: </span><span class="si">%d</span><span class="s1">efault]&#39;</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="pacman.loadAgent">
    <p>def <span class="ident">loadAgent</span>(</p><p>pacman, nographics)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.loadAgent', this);">Show source &equiv;</a></p>
  <div id="source-pacman.loadAgent" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">loadAgent</span><span class="p">(</span><span class="n">pacman</span><span class="p">,</span> <span class="n">nographics</span><span class="p">):</span>
    <span class="c1"># Looks through all pythonPath Directories for the right module,</span>
    <span class="n">pythonPathStr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="s2">&quot;$PYTHONPATH&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pythonPathStr</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">pythonPathDirs</span> <span class="o">=</span> <span class="n">pythonPathStr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pythonPathDirs</span> <span class="o">=</span> <span class="n">pythonPathStr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="n">pythonPathDirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">moduleDir</span> <span class="ow">in</span> <span class="n">pythonPathDirs</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">moduleDir</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">moduleNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">moduleDir</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;gents.py&#39;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">modulename</span> <span class="ow">in</span> <span class="n">moduleNames</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">modulename</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">pacman</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">module</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">nographics</span> <span class="ow">and</span> <span class="n">modulename</span> <span class="o">==</span> <span class="s1">&#39;keyboardAgents.py&#39;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Using the keyboard requires graphics (not text display)&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">pacman</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;The agent &#39;</span> <span class="o">+</span> <span class="n">pacman</span> <span class="o">+</span> <span class="s1">&#39; is not specified in any *Agents.py.&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="pacman.parseAgentArgs">
    <p>def <span class="ident">parseAgentArgs</span>(</p><p>str)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.parseAgentArgs', this);">Show source &equiv;</a></p>
  <div id="source-pacman.parseAgentArgs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">parseAgentArgs</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">str</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>
    <span class="n">pieces</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">opts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pieces</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">p</span><span class="p">,</span> <span class="mi">1</span>
        <span class="n">opts</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
    <span class="k">return</span> <span class="n">opts</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="pacman.readCommand">
    <p>def <span class="ident">readCommand</span>(</p><p>argv)</p>
    </div>
    

    
  
    <div class="desc"><p>Processes the command used to run pacman from the command line.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.readCommand', this);">Show source &equiv;</a></p>
  <div id="source-pacman.readCommand" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">readCommand</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Processes the command used to run pacman from the command line.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">usageStr</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    USAGE:      python pacman.py &lt;options&gt;</span>
<span class="s2">    EXAMPLES:   (1) python pacman.py</span>
<span class="s2">                    - starts an interactive game</span>
<span class="s2">                (2) python pacman.py --layout smallClassic --zoom 2</span>
<span class="s2">                OR  python pacman.py -l smallClassic -z 2</span>
<span class="s2">                    - starts an interactive game on a smaller board, zoomed in</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">(</span><span class="n">usageStr</span><span class="p">)</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-n&#39;</span><span class="p">,</span> <span class="s1">&#39;--numGames&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;numGames&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;the number of GAMES to play&#39;</span><span class="p">),</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;GAMES&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-l&#39;</span><span class="p">,</span> <span class="s1">&#39;--layout&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;layout&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;the LAYOUT_FILE from which to load the map layout&#39;</span><span class="p">),</span>
                      <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;LAYOUT_FILE&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;mediumClassic&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="s1">&#39;--pacman&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;pacman&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;the agent TYPE in the pacmanAgents module to use&#39;</span><span class="p">),</span>
                      <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;TYPE&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;KeyboardAgent&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="s1">&#39;--textGraphics&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;textGraphics&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Display output as text only&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-q&#39;</span><span class="p">,</span> <span class="s1">&#39;--quietTextGraphics&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;quietGraphics&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Generate minimal output and no graphics&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-g&#39;</span><span class="p">,</span> <span class="s1">&#39;--ghosts&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;ghost&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;the ghost agent TYPE in the ghostAgents module to use&#39;</span><span class="p">),</span>
                      <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;TYPE&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;RandomGhost&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="s1">&#39;--numghosts&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;numGhosts&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;The maximum number of ghosts to use&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-z&#39;</span><span class="p">,</span> <span class="s1">&#39;--zoom&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;zoom&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;Zoom the size of the graphics window&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="s1">&#39;--fixRandomSeed&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;fixRandomSeed&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Fixes the random seed to always play the same game&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="s1">&#39;--recordActions&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;record&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Writes game histories to a file (named by the time they were played)&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;--replay&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;gameToReplay&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;A recorded game file (pickle) to replay&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-a&#39;</span><span class="p">,</span> <span class="s1">&#39;--agentArgs&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;agentArgs&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Comma separated values sent to agent. e.g. &quot;opt1=val1,opt2,opt3=val3&quot;&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-x&#39;</span><span class="p">,</span> <span class="s1">&#39;--numTraining&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;numTraining&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;How many episodes are training (suppresses output)&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;--frameTime&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;frameTime&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;Time to delay between frames; &lt;0 means keyboard&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span> <span class="s1">&#39;--catchExceptions&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;catchExceptions&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Turns on exception handling and timeouts during games&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s1">&#39;--timeout&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;timeout&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="n">default</span><span class="p">(</span><span class="s1">&#39;Maximum length of time an agent can spend computing in a single game&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

    <span class="n">options</span><span class="p">,</span> <span class="n">otherjunk</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherjunk</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Command line input not understood: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">otherjunk</span><span class="p">))</span>
    <span class="n">args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="c1"># Fix the random seed</span>
    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">fixRandomSeed</span><span class="p">:</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="s1">&#39;cs188&#39;</span><span class="p">)</span>

    <span class="c1"># Choose a layout</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">getLayout</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The layout &quot;</span> <span class="o">+</span> <span class="n">options</span><span class="o">.</span><span class="n">layout</span> <span class="o">+</span> <span class="s2">&quot; cannot be found&quot;</span><span class="p">)</span>

    <span class="c1"># Choose a Pacman agent</span>
    <span class="n">noKeyboard</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">gameToReplay</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">textGraphics</span> <span class="ow">or</span> <span class="n">options</span><span class="o">.</span><span class="n">quietGraphics</span><span class="p">)</span>
    <span class="n">pacmanType</span> <span class="o">=</span> <span class="n">loadAgent</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">pacman</span><span class="p">,</span> <span class="n">noKeyboard</span><span class="p">)</span>
    <span class="n">agentOpts</span> <span class="o">=</span> <span class="n">parseAgentArgs</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">agentArgs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">numTraining</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;numTraining&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">numTraining</span>
        <span class="k">if</span> <span class="s1">&#39;numTraining&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">agentOpts</span><span class="p">:</span>
            <span class="n">agentOpts</span><span class="p">[</span><span class="s1">&#39;numTraining&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">numTraining</span>
    <span class="n">pacman</span> <span class="o">=</span> <span class="n">pacmanType</span><span class="p">(</span><span class="o">**</span><span class="n">agentOpts</span><span class="p">)</span>  <span class="c1"># Instantiate Pacman with agentArgs</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;pacman&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pacman</span>

    <span class="c1"># Don&#39;t display training games</span>
    <span class="k">if</span> <span class="s1">&#39;numTrain&#39;</span> <span class="ow">in</span> <span class="n">agentOpts</span><span class="p">:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">numQuiet</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">agentOpts</span><span class="p">[</span><span class="s1">&#39;numTrain&#39;</span><span class="p">])</span>
        <span class="n">options</span><span class="o">.</span><span class="n">numIgnore</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">agentOpts</span><span class="p">[</span><span class="s1">&#39;numTrain&#39;</span><span class="p">])</span>

    <span class="c1"># Choose a ghost agent</span>
    <span class="n">ghostType</span> <span class="o">=</span> <span class="n">loadAgent</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">ghost</span><span class="p">,</span> <span class="n">noKeyboard</span><span class="p">)</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;ghosts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ghostType</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">numGhosts</span><span class="p">)]</span>

    <span class="c1"># Choose a display format</span>
    <span class="kn">import</span> <span class="nn">textDisplay</span>  <span class="c1"># can&#39;t import at the top, because of cyclic import dependencies :-(</span>
    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">quietGraphics</span><span class="p">:</span>
        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;display&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">textDisplay</span><span class="o">.</span><span class="n">NullGraphics</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">options</span><span class="o">.</span><span class="n">textGraphics</span><span class="p">:</span>
        <span class="n">textDisplay</span><span class="o">.</span><span class="n">SLEEP_TIME</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">frameTime</span>
        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;display&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">textDisplay</span><span class="o">.</span><span class="n">PacmanGraphics</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;display&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphicsDisplay</span><span class="o">.</span><span class="n">PacmanGraphics</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">zoom</span><span class="p">,</span> <span class="n">frameTime</span><span class="o">=</span><span class="n">options</span><span class="o">.</span><span class="n">frameTime</span><span class="p">)</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;numGames&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">numGames</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;record&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">record</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;catchExceptions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">catchExceptions</span>
    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;timeout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">timeout</span>

    <span class="c1"># Special case: recorded games don&#39;t use the runGames method or args structure</span>
    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">gameToReplay</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Replaying recorded game </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="n">options</span><span class="o">.</span><span class="n">gameToReplay</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">gameToReplay</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">recorded</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">recorded</span><span class="p">[</span><span class="s1">&#39;display&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;display&#39;</span><span class="p">]</span>
        <span class="n">replayGame</span><span class="p">(</span><span class="o">**</span><span class="n">recorded</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">args</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="pacman.replayGame">
    <p>def <span class="ident">replayGame</span>(</p><p>layout, actions, display)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.replayGame', this);">Show source &equiv;</a></p>
  <div id="source-pacman.replayGame" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">replayGame</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">display</span><span class="p">):</span>
    <span class="n">rules</span> <span class="o">=</span> <span class="n">ClassicGameRules</span><span class="p">()</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="p">[</span><span class="n">pacmanAgents</span><span class="o">.</span><span class="n">GreedyAgent</span><span class="p">()]</span> <span class="o">+</span> <span class="p">[</span><span class="n">ghostAgents</span><span class="o">.</span><span class="n">RandomGhost</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">layout</span><span class="o">.</span><span class="n">getNumGhosts</span><span class="p">())]</span>
    <span class="n">game</span> <span class="o">=</span> <span class="n">rules</span><span class="o">.</span><span class="n">newGame</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">agents</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">agents</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">display</span><span class="p">)</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">state</span>
    <span class="n">display</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
        <span class="c1"># Execute the action</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="o">*</span><span class="n">action</span><span class="p">)</span>
        <span class="c1"># Change the display</span>
        <span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># Allow for game specific conditions (winning, losing, etc.)</span>
        <span class="n">rules</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">)</span>

    <span class="n">display</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="pacman.runGames">
    <p>def <span class="ident">runGames</span>(</p><p>layout, pacman, ghosts, display, numGames, record, numTraining=0, catchExceptions=False, timeout=30)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.runGames', this);">Show source &equiv;</a></p>
  <div id="source-pacman.runGames" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">runGames</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">pacman</span><span class="p">,</span> <span class="n">ghosts</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">numGames</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">numTraining</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">catchExceptions</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
    <span class="n">rules</span> <span class="o">=</span> <span class="n">ClassicGameRules</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
    <span class="n">games</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numGames</span><span class="p">):</span>
        <span class="n">beQuiet</span> <span class="o">=</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">numTraining</span>
        <span class="k">if</span> <span class="n">beQuiet</span><span class="p">:</span>
            <span class="c1"># Suppress output and graphics</span>
            <span class="kn">import</span> <span class="nn">textDisplay</span>  <span class="c1"># can&#39;t import at the top, because of cyclic import dependencies :-(</span>
            <span class="n">gameDisplay</span> <span class="o">=</span> <span class="n">textDisplay</span><span class="o">.</span><span class="n">NullGraphics</span><span class="p">()</span>
            <span class="n">rules</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gameDisplay</span> <span class="o">=</span> <span class="n">display</span>
            <span class="n">rules</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">game</span> <span class="o">=</span> <span class="n">rules</span><span class="o">.</span><span class="n">newGame</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">pacman</span><span class="p">,</span> <span class="n">ghosts</span><span class="p">,</span> <span class="n">gameDisplay</span><span class="p">,</span> <span class="n">beQuiet</span><span class="p">,</span> <span class="n">catchExceptions</span><span class="p">)</span>
        <span class="n">game</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">beQuiet</span><span class="p">:</span>
            <span class="n">games</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">game</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">record</span><span class="p">:</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;recorded-game-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]])</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">components</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;layout&#39;</span><span class="p">:</span> <span class="n">layout</span><span class="p">,</span> <span class="s1">&#39;actions&#39;</span><span class="p">:</span> <span class="n">game</span><span class="o">.</span><span class="n">moveHistory</span><span class="p">}</span>
                <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">numGames</span> <span class="o">-</span> <span class="n">numTraining</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">game</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">getScore</span><span class="p">()</span> <span class="k">for</span> <span class="n">game</span> <span class="ow">in</span> <span class="n">games</span><span class="p">]</span>
        <span class="n">wins</span> <span class="o">=</span> <span class="p">[</span><span class="n">game</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">isWin</span><span class="p">()</span> <span class="k">for</span> <span class="n">game</span> <span class="ow">in</span> <span class="n">games</span><span class="p">]</span>
        <span class="n">winRate</span> <span class="o">=</span> <span class="n">wins</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wins</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Average Score:&#39;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="p">)))</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Scores:       &#39;</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">]))</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Win Rate:      </span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1"> (</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wins</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="bp">True</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wins</span><span class="p">),</span> <span class="n">winRate</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Record:       &#39;</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([[</span><span class="s1">&#39;Loss&#39;</span><span class="p">,</span> <span class="s1">&#39;Win&#39;</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">w</span><span class="p">)]</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">wins</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">games</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="pacman.ClassicGameRules" class="name">class <span class="ident">ClassicGameRules</span></p>
      
  
    <div class="desc"><p>These game rules manage the control flow of a game, deciding when
and how the game starts and ends.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.ClassicGameRules', this);">Show source &equiv;</a></p>
  <div id="source-pacman.ClassicGameRules" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ClassicGameRules</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    These game rules manage the control flow of a game, deciding when</span>
<span class="sd">    and how the game starts and ends.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialState</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">newGame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout</span><span class="p">,</span> <span class="n">pacmanAgent</span><span class="p">,</span> <span class="n">ghostAgents</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">catchExceptions</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="n">pacmanAgent</span><span class="o">.</span><span class="n">prepareForNewGame</span><span class="p">()</span>
        <span class="n">agents</span> <span class="o">=</span> <span class="p">[</span><span class="n">pacmanAgent</span><span class="p">]</span> <span class="o">+</span> <span class="n">ghostAgents</span><span class="p">[:</span><span class="n">layout</span><span class="o">.</span><span class="n">getNumGhosts</span><span class="p">()]</span>
        <span class="n">initState</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">()</span>
        <span class="n">initState</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ghostAgents</span><span class="p">))</span>
        <span class="n">game</span> <span class="o">=</span> <span class="n">Game</span><span class="p">(</span><span class="n">agents</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">catchExceptions</span><span class="o">=</span><span class="n">catchExceptions</span><span class="p">)</span>
        <span class="n">game</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">initState</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialState</span> <span class="o">=</span> <span class="n">initState</span><span class="o">.</span><span class="n">deepCopy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="n">quiet</span>
        <span class="k">return</span> <span class="n">game</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks to see whether it is time to end the game.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">isWin</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">win</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">isLose</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lose</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">win</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Pacman emerges victorious! Score: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
        <span class="n">game</span><span class="o">.</span><span class="n">gameOver</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">lose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Pacman died! Score: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
        <span class="n">game</span><span class="o">.</span><span class="n">gameOver</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">getProgress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">game</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">getNumFood</span><span class="p">())</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialState</span><span class="o">.</span><span class="n">getNumFood</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">agentCrash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Pacman crashed&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;A ghost crashed&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getMaxTotalTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>

    <span class="k">def</span> <span class="nf">getMaxStartupTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>

    <span class="k">def</span> <span class="nf">getMoveWarningTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>

    <span class="k">def</span> <span class="nf">getMoveTimeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>

    <span class="k">def</span> <span class="nf">getMaxTimeWarnings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#pacman.ClassicGameRules">ClassicGameRules</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="pacman.ClassicGameRules.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, timeout=30)</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize self.  See help(type(self)) for accurate signature.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.ClassicGameRules.__init__', this);">Show source &equiv;</a></p>
  <div id="source-pacman.ClassicGameRules.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initialState</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.ClassicGameRules.agentCrash">
    <p>def <span class="ident">agentCrash</span>(</p><p>self, game, agentIndex)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.ClassicGameRules.agentCrash', this);">Show source &equiv;</a></p>
  <div id="source-pacman.ClassicGameRules.agentCrash" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">agentCrash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Pacman crashed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;A ghost crashed&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.ClassicGameRules.getMaxStartupTime">
    <p>def <span class="ident">getMaxStartupTime</span>(</p><p>self, agentIndex)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.ClassicGameRules.getMaxStartupTime', this);">Show source &equiv;</a></p>
  <div id="source-pacman.ClassicGameRules.getMaxStartupTime" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getMaxStartupTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.ClassicGameRules.getMaxTimeWarnings">
    <p>def <span class="ident">getMaxTimeWarnings</span>(</p><p>self, agentIndex)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.ClassicGameRules.getMaxTimeWarnings', this);">Show source &equiv;</a></p>
  <div id="source-pacman.ClassicGameRules.getMaxTimeWarnings" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getMaxTimeWarnings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.ClassicGameRules.getMaxTotalTime">
    <p>def <span class="ident">getMaxTotalTime</span>(</p><p>self, agentIndex)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.ClassicGameRules.getMaxTotalTime', this);">Show source &equiv;</a></p>
  <div id="source-pacman.ClassicGameRules.getMaxTotalTime" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getMaxTotalTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.ClassicGameRules.getMoveTimeout">
    <p>def <span class="ident">getMoveTimeout</span>(</p><p>self, agentIndex)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.ClassicGameRules.getMoveTimeout', this);">Show source &equiv;</a></p>
  <div id="source-pacman.ClassicGameRules.getMoveTimeout" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getMoveTimeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.ClassicGameRules.getMoveWarningTime">
    <p>def <span class="ident">getMoveWarningTime</span>(</p><p>self, agentIndex)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.ClassicGameRules.getMoveWarningTime', this);">Show source &equiv;</a></p>
  <div id="source-pacman.ClassicGameRules.getMoveWarningTime" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getMoveWarningTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.ClassicGameRules.getProgress">
    <p>def <span class="ident">getProgress</span>(</p><p>self, game)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.ClassicGameRules.getProgress', this);">Show source &equiv;</a></p>
  <div id="source-pacman.ClassicGameRules.getProgress" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getProgress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">game</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">getNumFood</span><span class="p">())</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialState</span><span class="o">.</span><span class="n">getNumFood</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.ClassicGameRules.lose">
    <p>def <span class="ident">lose</span>(</p><p>self, state, game)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.ClassicGameRules.lose', this);">Show source &equiv;</a></p>
  <div id="source-pacman.ClassicGameRules.lose" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">lose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Pacman died! Score: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
    <span class="n">game</span><span class="o">.</span><span class="n">gameOver</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.ClassicGameRules.newGame">
    <p>def <span class="ident">newGame</span>(</p><p>self, layout, pacmanAgent, ghostAgents, display, quiet=False, catchExceptions=False)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.ClassicGameRules.newGame', this);">Show source &equiv;</a></p>
  <div id="source-pacman.ClassicGameRules.newGame" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">newGame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout</span><span class="p">,</span> <span class="n">pacmanAgent</span><span class="p">,</span> <span class="n">ghostAgents</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">catchExceptions</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="n">pacmanAgent</span><span class="o">.</span><span class="n">prepareForNewGame</span><span class="p">()</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="p">[</span><span class="n">pacmanAgent</span><span class="p">]</span> <span class="o">+</span> <span class="n">ghostAgents</span><span class="p">[:</span><span class="n">layout</span><span class="o">.</span><span class="n">getNumGhosts</span><span class="p">()]</span>
    <span class="n">initState</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">()</span>
    <span class="n">initState</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ghostAgents</span><span class="p">))</span>
    <span class="n">game</span> <span class="o">=</span> <span class="n">Game</span><span class="p">(</span><span class="n">agents</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">catchExceptions</span><span class="o">=</span><span class="n">catchExceptions</span><span class="p">)</span>
    <span class="n">game</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">initState</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initialState</span> <span class="o">=</span> <span class="n">initState</span><span class="o">.</span><span class="n">deepCopy</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="n">quiet</span>
    <span class="k">return</span> <span class="n">game</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.ClassicGameRules.process">
    <p>def <span class="ident">process</span>(</p><p>self, state, game)</p>
    </div>
    

    
  
    <div class="desc"><p>Checks to see whether it is time to end the game.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.ClassicGameRules.process', this);">Show source &equiv;</a></p>
  <div id="source-pacman.ClassicGameRules.process" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks to see whether it is time to end the game.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">isWin</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">win</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">isLose</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lose</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.ClassicGameRules.win">
    <p>def <span class="ident">win</span>(</p><p>self, state, game)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.ClassicGameRules.win', this);">Show source &equiv;</a></p>
  <div id="source-pacman.ClassicGameRules.win" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">win</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">game</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Pacman emerges victorious! Score: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
    <span class="n">game</span><span class="o">.</span><span class="n">gameOver</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="pacman.ClassicGameRules.initialState" class="name">var <span class="ident">initialState</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pacman.ClassicGameRules.quiet" class="name">var <span class="ident">quiet</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pacman.ClassicGameRules.timeout" class="name">var <span class="ident">timeout</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="pacman.GameState" class="name">class <span class="ident">GameState</span></p>
      
  
    <div class="desc"><p>A GameState specifies the full game state, including the food, capsules,
agent configurations and score changes.</p>
<p>GameStates are used by the Game object to capture the actual state of the game and
can be used by agents to reason about the game.</p>
<p>Much of the information in a GameState is stored in a GameStateData object.  We
strongly suggest that you access that data via the accessor methods below rather
than referring to the GameStateData object directly.</p>
<p>Note that in classic Pacman, Pacman is always agent 0.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">GameState</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A GameState specifies the full game state, including the food, capsules,</span>
<span class="sd">    agent configurations and score changes.</span>

<span class="sd">    GameStates are used by the Game object to capture the actual state of the game and</span>
<span class="sd">    can be used by agents to reason about the game.</span>

<span class="sd">    Much of the information in a GameState is stored in a GameStateData object.  We</span>
<span class="sd">    strongly suggest that you access that data via the accessor methods below rather</span>
<span class="sd">    than referring to the GameStateData object directly.</span>

<span class="sd">    Note that in classic Pacman, Pacman is always agent 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">####################################################</span>
    <span class="c1"># Accessor methods: use these to access state data #</span>
    <span class="c1">####################################################</span>

    <span class="c1"># static variable keeps track of which states have had getLegalActions called</span>
    <span class="n">explored</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getAndResetExplored</span><span class="p">():</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">GameState</span><span class="o">.</span><span class="n">explored</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">GameState</span><span class="o">.</span><span class="n">explored</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">tmp</span>

    <span class="n">getAndResetExplored</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">getAndResetExplored</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getLegalActions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the legal actions for the agent specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">GameState</span><span class="o">.</span><span class="n">explored</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isWin</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">isLose</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Pacman is moving</span>
            <span class="k">return</span> <span class="n">PacmanRules</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generateSuccessor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the successor state after the specified agent takes the action.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check that successors exist</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isWin</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">isLose</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Can</span><span class="se">\&#39;</span><span class="s1">t generate a successor of a terminal state.&#39;</span><span class="p">)</span>

        <span class="c1"># Copy current state</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Let agent&#39;s logic deal with its action&#39;s effects on the board</span>
        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Pacman is moving</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_eaten</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="n">state</span><span class="o">.</span><span class="n">getNumAgents</span><span class="p">()</span>
            <span class="n">PacmanRules</span><span class="o">.</span><span class="n">applyAction</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># A ghost is moving</span>
            <span class="n">GhostRules</span><span class="o">.</span><span class="n">applyAction</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">)</span>

        <span class="c1"># Time passes</span>
        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">+=</span> <span class="o">-</span><span class="n">TIME_PENALTY</span>  <span class="c1"># Penalty for waiting around</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">GhostRules</span><span class="o">.</span><span class="n">decrementTimer</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">])</span>

        <span class="c1"># Resolve multi-agent effects</span>
        <span class="n">GhostRules</span><span class="o">.</span><span class="n">checkDeath</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">)</span>

        <span class="c1"># Book keeping</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_agentMoved</span> <span class="o">=</span> <span class="n">agentIndex</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">score</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">getLegalPacmanActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generatePacmanSuccessor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the successor state after the specified pacman move</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getPacmanState</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an AgentState object for pacman (in game.py)</span>

<span class="sd">        state.pos gives the current position</span>
<span class="sd">        state.direction gives the travel vector</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getPacmanPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getGhostStates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">def</span> <span class="nf">getGhostState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">agentIndex</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumAgents</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid index passed to getGhostState&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">getGhostPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Pacman&#39;s index passed to getGhostPosition&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">]</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getGhostPositions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGhostStates</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">getNumAgents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getScore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">score</span>

    <span class="k">def</span> <span class="nf">getCapsules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of positions (x,y) of the remaining capsules.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">capsules</span>

    <span class="k">def</span> <span class="nf">getNumFood</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getFood</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a Grid of boolean food indicator variables.</span>

<span class="sd">        Grids can be accessed via list notation, so to check</span>
<span class="sd">        if there is food at (x,y), just call</span>

<span class="sd">        currentFood = state.getFood()</span>
<span class="sd">        if currentFood[x][y] == True: ...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span>

    <span class="k">def</span> <span class="nf">getWalls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a Grid of boolean wall indicator variables.</span>

<span class="sd">        Grids can be accessed via list notation, so to check</span>
<span class="sd">        if there is food at (x,y), just call</span>

<span class="sd">        walls = state.getWalls()</span>
<span class="sd">        if walls[x][y] == True: ...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">walls</span>

    <span class="k">def</span> <span class="nf">hasFood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">hasWall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">walls</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">isLose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_lose</span>

    <span class="k">def</span> <span class="nf">isWin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_win</span>

    <span class="c1">#############################################</span>
    <span class="c1">#             Helper methods:               #</span>
    <span class="c1"># You shouldn&#39;t need to call these directly #</span>
    <span class="c1">#############################################</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prevState</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a new state by copying information from its predecessor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">prevState</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>  <span class="c1"># Initial state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">GameStateData</span><span class="p">(</span><span class="n">prevState</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">GameStateData</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">deepCopy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">deepCopy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows two states to be compared.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows states to be keys of dictionaries.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout</span><span class="p">,</span> <span class="n">numGhostAgents</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an initial game state from a layout array (see layout.py).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">numGhostAgents</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#pacman.GameState">GameState</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="pacman.GameState.explored" class="name">var <span class="ident">explored</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="pacman.GameState.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, prevState=None)</p>
    </div>
    

    
  
    <div class="desc"><p>Generates a new state by copying information from its predecessor.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.__init__', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prevState</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a new state by copying information from its predecessor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">prevState</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>  <span class="c1"># Initial state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">GameStateData</span><span class="p">(</span><span class="n">prevState</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">GameStateData</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.deepCopy">
    <p>def <span class="ident">deepCopy</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.deepCopy', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.deepCopy" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">deepCopy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">state</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">deepCopy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">state</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.generatePacmanSuccessor">
    <p>def <span class="ident">generatePacmanSuccessor</span>(</p><p>self, action)</p>
    </div>
    

    
  
    <div class="desc"><p>Generates the successor state after the specified pacman move</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.generatePacmanSuccessor', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.generatePacmanSuccessor" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">generatePacmanSuccessor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates the successor state after the specified pacman move</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.generateSuccessor">
    <p>def <span class="ident">generateSuccessor</span>(</p><p>self, agentIndex, action)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the successor state after the specified agent takes the action.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.generateSuccessor', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.generateSuccessor" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">generateSuccessor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the successor state after the specified agent takes the action.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check that successors exist</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isWin</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">isLose</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Can</span><span class="se">\&#39;</span><span class="s1">t generate a successor of a terminal state.&#39;</span><span class="p">)</span>
    <span class="c1"># Copy current state</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">GameState</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="c1"># Let agent&#39;s logic deal with its action&#39;s effects on the board</span>
    <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Pacman is moving</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_eaten</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="n">state</span><span class="o">.</span><span class="n">getNumAgents</span><span class="p">()</span>
        <span class="n">PacmanRules</span><span class="o">.</span><span class="n">applyAction</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># A ghost is moving</span>
        <span class="n">GhostRules</span><span class="o">.</span><span class="n">applyAction</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">)</span>
    <span class="c1"># Time passes</span>
    <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">+=</span> <span class="o">-</span><span class="n">TIME_PENALTY</span>  <span class="c1"># Penalty for waiting around</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">GhostRules</span><span class="o">.</span><span class="n">decrementTimer</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">])</span>
    <span class="c1"># Resolve multi-agent effects</span>
    <span class="n">GhostRules</span><span class="o">.</span><span class="n">checkDeath</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">)</span>
    <span class="c1"># Book keeping</span>
    <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_agentMoved</span> <span class="o">=</span> <span class="n">agentIndex</span>
    <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">score</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span>
    <span class="k">return</span> <span class="n">state</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getAndResetExplored">
    <p>def <span class="ident">getAndResetExplored</span>(</p><p>)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getAndResetExplored', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getAndResetExplored" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getAndResetExplored</span><span class="p">():</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">GameState</span><span class="o">.</span><span class="n">explored</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">GameState</span><span class="o">.</span><span class="n">explored</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tmp</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getCapsules">
    <p>def <span class="ident">getCapsules</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a list of positions (x,y) of the remaining capsules.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getCapsules', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getCapsules" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getCapsules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of positions (x,y) of the remaining capsules.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">capsules</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getFood">
    <p>def <span class="ident">getFood</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a Grid of boolean food indicator variables.</p>
<p>Grids can be accessed via list notation, so to check
if there is food at (x,y), just call</p>
<p>currentFood = state.getFood()
if currentFood[x][y] == True: ...</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getFood', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getFood" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getFood</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a Grid of boolean food indicator variables.</span>
<span class="sd">    Grids can be accessed via list notation, so to check</span>
<span class="sd">    if there is food at (x,y), just call</span>
<span class="sd">    currentFood = state.getFood()</span>
<span class="sd">    if currentFood[x][y] == True: ...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getGhostPosition">
    <p>def <span class="ident">getGhostPosition</span>(</p><p>self, agentIndex)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getGhostPosition', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getGhostPosition" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getGhostPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Pacman&#39;s index passed to getGhostPosition&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">]</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getGhostPositions">
    <p>def <span class="ident">getGhostPositions</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getGhostPositions', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getGhostPositions" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getGhostPositions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGhostStates</span><span class="p">()]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getGhostState">
    <p>def <span class="ident">getGhostState</span>(</p><p>self, agentIndex)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getGhostState', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getGhostState" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getGhostState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">agentIndex</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumAgents</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid index passed to getGhostState&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getGhostStates">
    <p>def <span class="ident">getGhostStates</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getGhostStates', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getGhostStates" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getGhostStates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getLegalActions">
    <p>def <span class="ident">getLegalActions</span>(</p><p>self, agentIndex=0)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the legal actions for the agent specified.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getLegalActions', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getLegalActions" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getLegalActions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the legal actions for the agent specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">GameState</span><span class="o">.</span><span class="n">explored</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isWin</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">isLose</span><span class="p">():</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Pacman is moving</span>
        <span class="k">return</span> <span class="n">PacmanRules</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getLegalPacmanActions">
    <p>def <span class="ident">getLegalPacmanActions</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getLegalPacmanActions', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getLegalPacmanActions" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getLegalPacmanActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getNumAgents">
    <p>def <span class="ident">getNumAgents</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getNumAgents', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getNumAgents" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getNumAgents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getNumFood">
    <p>def <span class="ident">getNumFood</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getNumFood', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getNumFood" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getNumFood</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getPacmanPosition">
    <p>def <span class="ident">getPacmanPosition</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getPacmanPosition', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getPacmanPosition" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getPacmanPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getPacmanState">
    <p>def <span class="ident">getPacmanState</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns an AgentState object for pacman (in game.py)</p>
<p>state.pos gives the current position
state.direction gives the travel vector</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getPacmanState', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getPacmanState" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getPacmanState</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an AgentState object for pacman (in game.py)</span>
<span class="sd">    state.pos gives the current position</span>
<span class="sd">    state.direction gives the travel vector</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getScore">
    <p>def <span class="ident">getScore</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getScore', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getScore" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getScore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">score</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.getWalls">
    <p>def <span class="ident">getWalls</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a Grid of boolean wall indicator variables.</p>
<p>Grids can be accessed via list notation, so to check
if there is food at (x,y), just call</p>
<p>walls = state.getWalls()
if walls[x][y] == True: ...</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.getWalls', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.getWalls" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getWalls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a Grid of boolean wall indicator variables.</span>
<span class="sd">    Grids can be accessed via list notation, so to check</span>
<span class="sd">    if there is food at (x,y), just call</span>
<span class="sd">    walls = state.getWalls()</span>
<span class="sd">    if walls[x][y] == True: ...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">walls</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.hasFood">
    <p>def <span class="ident">hasFood</span>(</p><p>self, x, y)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.hasFood', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.hasFood" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hasFood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.hasWall">
    <p>def <span class="ident">hasWall</span>(</p><p>self, x, y)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.hasWall', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.hasWall" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">hasWall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">walls</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.initialize">
    <p>def <span class="ident">initialize</span>(</p><p>self, layout, numGhostAgents=1000)</p>
    </div>
    

    
  
    <div class="desc"><p>Creates an initial game state from a layout array (see layout.py).</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.initialize', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.initialize" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout</span><span class="p">,</span> <span class="n">numGhostAgents</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates an initial game state from a layout array (see layout.py).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">numGhostAgents</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.isLose">
    <p>def <span class="ident">isLose</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.isLose', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.isLose" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">isLose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_lose</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GameState.isWin">
    <p>def <span class="ident">isWin</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GameState.isWin', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GameState.isWin" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">isWin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_win</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="pacman.GhostRules" class="name">class <span class="ident">GhostRules</span></p>
      
  
    <div class="desc"><p>These functions dictate how ghosts interact with their environment.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GhostRules', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GhostRules" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">GhostRules</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    These functions dictate how ghosts interact with their environment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">GHOST_SPEED</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">def</span> <span class="nf">getLegalActions</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostIndex</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ghosts cannot stop, and cannot turn around unless they</span>
<span class="sd">        reach a dead end, but can turn 90 degrees at intersections.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">conf</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">getGhostState</span><span class="p">(</span><span class="n">ghostIndex</span><span class="p">)</span><span class="o">.</span><span class="n">configuration</span>
        <span class="n">possibleActions</span> <span class="o">=</span> <span class="n">Actions</span><span class="o">.</span><span class="n">getPossibleActions</span><span class="p">(</span><span class="n">conf</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">walls</span><span class="p">)</span>
        <span class="n">reverse</span> <span class="o">=</span> <span class="n">Actions</span><span class="o">.</span><span class="n">reverseDirection</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Directions</span><span class="o">.</span><span class="n">STOP</span> <span class="ow">in</span> <span class="n">possibleActions</span><span class="p">:</span>
            <span class="n">possibleActions</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">Directions</span><span class="o">.</span><span class="n">STOP</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reverse</span> <span class="ow">in</span> <span class="n">possibleActions</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">possibleActions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">possibleActions</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">reverse</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">possibleActions</span>

    <span class="n">getLegalActions</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">getLegalActions</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">applyAction</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">ghostIndex</span><span class="p">):</span>

        <span class="n">legal</span> <span class="o">=</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostIndex</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">action</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">legal</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Illegal ghost action &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">action</span><span class="p">))</span>

        <span class="n">ghostState</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">ghostIndex</span><span class="p">]</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">GHOST_SPEED</span>
        <span class="k">if</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">speed</span> <span class="o">/=</span> <span class="mf">2.0</span>
        <span class="n">vector</span> <span class="o">=</span> <span class="n">Actions</span><span class="o">.</span><span class="n">directionToVector</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">speed</span><span class="p">)</span>
        <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>

    <span class="n">applyAction</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">applyAction</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">decrementTimer</span><span class="p">(</span><span class="n">ghostState</span><span class="p">):</span>
        <span class="n">timer</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span>
        <span class="k">if</span> <span class="n">timer</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">nearestPoint</span><span class="p">(</span><span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
        <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">timer</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">decrementTimer</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">decrementTimer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">checkDeath</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="n">pacmanPosition</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">getPacmanPosition</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Pacman just moved; Anyone can kill him</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">)):</span>
                <span class="n">ghostState</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                <span class="n">ghostPosition</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">canKill</span><span class="p">(</span><span class="n">pacmanPosition</span><span class="p">,</span> <span class="n">ghostPosition</span><span class="p">):</span>
                    <span class="n">GhostRules</span><span class="o">.</span><span class="n">collide</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ghostState</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">]</span>
            <span class="n">ghostPosition</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">canKill</span><span class="p">(</span><span class="n">pacmanPosition</span><span class="p">,</span> <span class="n">ghostPosition</span><span class="p">):</span>
                <span class="n">GhostRules</span><span class="o">.</span><span class="n">collide</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">)</span>

    <span class="n">checkDeath</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">checkDeath</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">collide</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">+=</span> <span class="mi">200</span>
            <span class="n">GhostRules</span><span class="o">.</span><span class="n">placeGhost</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">)</span>
            <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># Added for first-person</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_eaten</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_win</span><span class="p">:</span>
                <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">-=</span> <span class="mi">500</span>
                <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_lose</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="n">collide</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">collide</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">canKill</span><span class="p">(</span><span class="n">pacmanPosition</span><span class="p">,</span> <span class="n">ghostPosition</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">manhattanDistance</span><span class="p">(</span><span class="n">ghostPosition</span><span class="p">,</span> <span class="n">pacmanPosition</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">COLLISION_TOLERANCE</span>

    <span class="n">canKill</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">canKill</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">placeGhost</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">):</span>
        <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">start</span>

    <span class="n">placeGhost</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">placeGhost</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#pacman.GhostRules">GhostRules</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="pacman.GhostRules.GHOST_SPEED" class="name">var <span class="ident">GHOST_SPEED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="pacman.GhostRules.applyAction">
    <p>def <span class="ident">applyAction</span>(</p><p>state, action, ghostIndex)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GhostRules.applyAction', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GhostRules.applyAction" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">applyAction</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">ghostIndex</span><span class="p">):</span>
    <span class="n">legal</span> <span class="o">=</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostIndex</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">action</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">legal</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Illegal ghost action &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">action</span><span class="p">))</span>
    <span class="n">ghostState</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">ghostIndex</span><span class="p">]</span>
    <span class="n">speed</span> <span class="o">=</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">GHOST_SPEED</span>
    <span class="k">if</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">speed</span> <span class="o">/=</span> <span class="mf">2.0</span>
    <span class="n">vector</span> <span class="o">=</span> <span class="n">Actions</span><span class="o">.</span><span class="n">directionToVector</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">speed</span><span class="p">)</span>
    <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GhostRules.canKill">
    <p>def <span class="ident">canKill</span>(</p><p>pacmanPosition, ghostPosition)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GhostRules.canKill', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GhostRules.canKill" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">canKill</span><span class="p">(</span><span class="n">pacmanPosition</span><span class="p">,</span> <span class="n">ghostPosition</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">manhattanDistance</span><span class="p">(</span><span class="n">ghostPosition</span><span class="p">,</span> <span class="n">pacmanPosition</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">COLLISION_TOLERANCE</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GhostRules.checkDeath">
    <p>def <span class="ident">checkDeath</span>(</p><p>state, agentIndex)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GhostRules.checkDeath', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GhostRules.checkDeath" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">checkDeath</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
    <span class="n">pacmanPosition</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">getPacmanPosition</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">agentIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Pacman just moved; Anyone can kill him</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">)):</span>
            <span class="n">ghostState</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="n">ghostPosition</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">canKill</span><span class="p">(</span><span class="n">pacmanPosition</span><span class="p">,</span> <span class="n">ghostPosition</span><span class="p">):</span>
                <span class="n">GhostRules</span><span class="o">.</span><span class="n">collide</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ghostState</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">]</span>
        <span class="n">ghostPosition</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">GhostRules</span><span class="o">.</span><span class="n">canKill</span><span class="p">(</span><span class="n">pacmanPosition</span><span class="p">,</span> <span class="n">ghostPosition</span><span class="p">):</span>
            <span class="n">GhostRules</span><span class="o">.</span><span class="n">collide</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GhostRules.collide">
    <p>def <span class="ident">collide</span>(</p><p>state, ghostState, agentIndex)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GhostRules.collide', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GhostRules.collide" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">collide</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">,</span> <span class="n">agentIndex</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">+=</span> <span class="mi">200</span>
        <span class="n">GhostRules</span><span class="o">.</span><span class="n">placeGhost</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">)</span>
        <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Added for first-person</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_eaten</span><span class="p">[</span><span class="n">agentIndex</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_win</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">-=</span> <span class="mi">500</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_lose</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GhostRules.decrementTimer">
    <p>def <span class="ident">decrementTimer</span>(</p><p>ghostState)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GhostRules.decrementTimer', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GhostRules.decrementTimer" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">decrementTimer</span><span class="p">(</span><span class="n">ghostState</span><span class="p">):</span>
    <span class="n">timer</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span>
    <span class="k">if</span> <span class="n">timer</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">nearestPoint</span><span class="p">(</span><span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
    <span class="n">ghostState</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">timer</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GhostRules.getLegalActions">
    <p>def <span class="ident">getLegalActions</span>(</p><p>state, ghostIndex)</p>
    </div>
    

    
  
    <div class="desc"><p>Ghosts cannot stop, and cannot turn around unless they
reach a dead end, but can turn 90 degrees at intersections.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GhostRules.getLegalActions', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GhostRules.getLegalActions" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getLegalActions</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostIndex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ghosts cannot stop, and cannot turn around unless they</span>
<span class="sd">    reach a dead end, but can turn 90 degrees at intersections.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">conf</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">getGhostState</span><span class="p">(</span><span class="n">ghostIndex</span><span class="p">)</span><span class="o">.</span><span class="n">configuration</span>
    <span class="n">possibleActions</span> <span class="o">=</span> <span class="n">Actions</span><span class="o">.</span><span class="n">getPossibleActions</span><span class="p">(</span><span class="n">conf</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">walls</span><span class="p">)</span>
    <span class="n">reverse</span> <span class="o">=</span> <span class="n">Actions</span><span class="o">.</span><span class="n">reverseDirection</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Directions</span><span class="o">.</span><span class="n">STOP</span> <span class="ow">in</span> <span class="n">possibleActions</span><span class="p">:</span>
        <span class="n">possibleActions</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">Directions</span><span class="o">.</span><span class="n">STOP</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reverse</span> <span class="ow">in</span> <span class="n">possibleActions</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">possibleActions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">possibleActions</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">reverse</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">possibleActions</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.GhostRules.placeGhost">
    <p>def <span class="ident">placeGhost</span>(</p><p>state, ghostState)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.GhostRules.placeGhost', this);">Show source &equiv;</a></p>
  <div id="source-pacman.GhostRules.placeGhost" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">placeGhost</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">ghostState</span><span class="p">):</span>
    <span class="n">ghostState</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="n">ghostState</span><span class="o">.</span><span class="n">start</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="pacman.PacmanRules" class="name">class <span class="ident">PacmanRules</span></p>
      
  
    <div class="desc"><p>These functions govern how pacman interacts with his environment under
the classic game rules.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.PacmanRules', this);">Show source &equiv;</a></p>
  <div id="source-pacman.PacmanRules" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">PacmanRules</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    These functions govern how pacman interacts with his environment under</span>
<span class="sd">    the classic game rules.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PACMAN_SPEED</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">getLegalActions</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of possible actions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Actions</span><span class="o">.</span><span class="n">getPossibleActions</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">getPacmanState</span><span class="p">()</span><span class="o">.</span><span class="n">configuration</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">walls</span><span class="p">)</span>

    <span class="n">getLegalActions</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">getLegalActions</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">applyAction</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Edits the state to reflect the results of the action.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">legal</span> <span class="o">=</span> <span class="n">PacmanRules</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">action</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">legal</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Illegal action &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">action</span><span class="p">))</span>

        <span class="n">pacmanState</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Update Configuration</span>
        <span class="n">vector</span> <span class="o">=</span> <span class="n">Actions</span><span class="o">.</span><span class="n">directionToVector</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">PacmanRules</span><span class="o">.</span><span class="n">PACMAN_SPEED</span><span class="p">)</span>
        <span class="n">pacmanState</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="n">pacmanState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>

        <span class="c1"># Eat</span>
        <span class="nb">next</span> <span class="o">=</span> <span class="n">pacmanState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
        <span class="n">nearest</span> <span class="o">=</span> <span class="n">nearestPoint</span><span class="p">(</span><span class="nb">next</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">manhattanDistance</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="c1"># Remove food</span>
            <span class="n">PacmanRules</span><span class="o">.</span><span class="n">consume</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

    <span class="n">applyAction</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">applyAction</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">position</span>
        <span class="c1"># Eat food</span>
        <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">+=</span> <span class="mi">10</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_foodEaten</span> <span class="o">=</span> <span class="n">position</span>
            <span class="c1"># TODO: cache numFood?</span>
            <span class="n">numFood</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">getNumFood</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">numFood</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_lose</span><span class="p">:</span>
                <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">+=</span> <span class="mi">500</span>
                <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_win</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="c1"># Eat capsule</span>
        <span class="k">if</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">getCapsules</span><span class="p">():</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">capsules</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_capsuleEaten</span> <span class="o">=</span> <span class="n">position</span>
            <span class="c1"># Reset all ghosts&#39; scared timers</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">)):</span>
                <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">=</span> <span class="n">SCARED_TIME</span>

    <span class="n">consume</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">consume</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#pacman.PacmanRules">PacmanRules</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="pacman.PacmanRules.PACMAN_SPEED" class="name">var <span class="ident">PACMAN_SPEED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="pacman.PacmanRules.applyAction">
    <p>def <span class="ident">applyAction</span>(</p><p>state, action)</p>
    </div>
    

    
  
    <div class="desc"><p>Edits the state to reflect the results of the action.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.PacmanRules.applyAction', this);">Show source &equiv;</a></p>
  <div id="source-pacman.PacmanRules.applyAction" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">applyAction</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Edits the state to reflect the results of the action.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">legal</span> <span class="o">=</span> <span class="n">PacmanRules</span><span class="o">.</span><span class="n">getLegalActions</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">action</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">legal</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Illegal action &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">action</span><span class="p">))</span>
    <span class="n">pacmanState</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Update Configuration</span>
    <span class="n">vector</span> <span class="o">=</span> <span class="n">Actions</span><span class="o">.</span><span class="n">directionToVector</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">PacmanRules</span><span class="o">.</span><span class="n">PACMAN_SPEED</span><span class="p">)</span>
    <span class="n">pacmanState</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="n">pacmanState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">generateSuccessor</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
    <span class="c1"># Eat</span>
    <span class="nb">next</span> <span class="o">=</span> <span class="n">pacmanState</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span>
    <span class="n">nearest</span> <span class="o">=</span> <span class="n">nearestPoint</span><span class="p">(</span><span class="nb">next</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">manhattanDistance</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="c1"># Remove food</span>
        <span class="n">PacmanRules</span><span class="o">.</span><span class="n">consume</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.PacmanRules.consume">
    <p>def <span class="ident">consume</span>(</p><p>position, state)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.PacmanRules.consume', this);">Show source &equiv;</a></p>
  <div id="source-pacman.PacmanRules.consume" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">position</span>
    <span class="c1"># Eat food</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]:</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">+=</span> <span class="mi">10</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">food</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_foodEaten</span> <span class="o">=</span> <span class="n">position</span>
        <span class="c1"># TODO: cache numFood?</span>
        <span class="n">numFood</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">getNumFood</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">numFood</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_lose</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">scoreChange</span> <span class="o">+=</span> <span class="mi">500</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_win</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="c1"># Eat capsule</span>
    <span class="k">if</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">getCapsules</span><span class="p">():</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">capsules</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">_capsuleEaten</span> <span class="o">=</span> <span class="n">position</span>
        <span class="c1"># Reset all ghosts&#39; scared timers</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">)):</span>
            <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">agentStates</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">scaredTimer</span> <span class="o">=</span> <span class="n">SCARED_TIME</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pacman.PacmanRules.getLegalActions">
    <p>def <span class="ident">getLegalActions</span>(</p><p>state)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a list of possible actions.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pacman.PacmanRules.getLegalActions', this);">Show source &equiv;</a></p>
  <div id="source-pacman.PacmanRules.getLegalActions" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">getLegalActions</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of possible actions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Actions</span><span class="o">.</span><span class="n">getPossibleActions</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">getPacmanState</span><span class="p">()</span><span class="o">.</span><span class="n">configuration</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">walls</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
